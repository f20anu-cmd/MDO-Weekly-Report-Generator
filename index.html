<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>MDO Weekly Report</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>

  <link rel="stylesheet" href="styles.css"/>

  <!-- Excel parser -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>

  <!-- PDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.2/dist/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
</head>

<body>
<header class="topbar">
  <div class="brand">
    <img src="assets/logo/logo.png" class="logo"/>
    <div>
      <div class="brandTitle">MDO Weekly Report</div>
      <div class="brandSub">Auto-loaded master data</div>
    </div>
  </div>

  <div class="barActions">
    <button id="btnPdf" class="btn btn-primary">Generate A4 PDF</button>
  </div>
</header>

<main class="container">

  <!-- MDO DETAILS -->
  <section class="card">
    <h2>1) MDO Details</h2>
    <div class="formGrid">
      <input id="mdoName" placeholder="MDO Name"/>
      <input id="headquarter" placeholder="Headquarter"/>
      <select id="region"></select>
      <select id="territory"></select>
      <select id="month"></select>
      <select id="week"></select>
    </div>
  </section>

  <!-- NPI PERFORMANCE -->
  <section class="card">
    <div class="sectionHead">
      <h2>2) NPI Performance</h2>
      <div>
        <button onclick="addNpiRow()" class="btn btn-outline">Add Row</button>
        <button onclick="clearNpi()" class="btn btn-outline danger">Clear</button>
      </div>
    </div>

    <table class="table" id="npiTable">
      <thead>
      <tr>
        <th>#</th>
        <th>Product (NPI)</th>
        <th>Plan</th>
        <th>Achievement</th>
        <th>Total Revenue (₹)</th>
        <th>Incentive Earned (₹)</th>
        <th></th>
      </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="npiSummary">
      <div class="npiMetric">
        <span>Total Incentive Earned</span>
        <strong id="npiIncentive">₹ 0</strong>
      </div>
      <div class="npiMetric">
        <span>Total Revenue Generated</span>
        <strong id="npiRevenue">₹ 0</strong>
      </div>
    </div>
  </section>

  <!-- OTHER PRODUCTS -->
  <section class="card">
    <div class="sectionHead">
      <h2>3) Other Product Performance</h2>
      <div>
        <button onclick="addOtherRow()" class="btn btn-outline">Add Row</button>
        <button onclick="clearOther()" class="btn btn-outline danger">Clear</button>
      </div>
    </div>

    <table class="table" id="otherTable">
      <thead>
      <tr>
        <th>#</th>
        <th>Product</th>
        <th>Plan</th>
        <th>Achievement</th>
        <th>Total Revenue (₹)</th>
        <th></th>
      </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="plainSummary">
      Total Revenue: <strong id="otherRevenue">₹ 0</strong>
    </div>
  </section>

</main>

<script src="app.js"></script>
<script src="pdf.js"></script>
</body>
</html>
